import random
from flask import Flask, render_template, request, jsonify

app = Flask(__name__)

# 【属性】（20種類）
styles = [
    "殺気を隠せない", "リリースが早すぎる", "根掛かりを恐れない", 
    "時合に命をかける", "ギアだけはプロ級の", "バックラッシュの天才", 
    "ボウズを恐れない", "潮目に敏感すぎる", "ドラグ音が大好物な", 
    "ノットが異常に速い", "ルアーの動きに厳しい", "防波堤と化した",
    "生餌に絶対の信頼を置く", "キャストが美しすぎる", "魚より道具を愛する",
    "荒天でも出撃する", "魚の気持ちがわかる", "常に大物を夢見る",
    "ラインの太さにこだわる", "偏光グラスが体の一部な"
]

# 【称号】（20種類）
jobs = [
    "ショアジギ狂い", "エサ取りの名手", "ランガンジャンキー", 
    "堤防の守護神", "ルアー紛失職人", "船酔いマスター", 
    "フィッシュグリップ職人", "ポイント開拓者", "外道ハンター", 
    "週末限定テスター", "キャスティング魔術師", "釣具屋の常連客",
    "爆釣の預言者", "ライントラブル製造機", "早合わせの達人",
    "居残り釣行の鬼", "クーラーボックスブレイカー", "タモ入れ失敗のプロ",
    "ノット組み直し職人", "ポイント清掃員"
]

# 【仙人の一言】（アングラーの心に刺さるネタを大量投入！）
comments = [
    "お前の殺気で、半径50mの魚が散っておるぞ。まずは深呼吸じゃ。",
    "そのキャスト、隣のアングラーがお前のルアーをずっと見とるぞ。",
    "根掛かりを『魚の反応』と言い張るのは、もう卒業するんじゃな。",
    "タックルを磨く暇があるなら、まずは潮見表を100回見直せ。",
    "お前のルアーボックス、全部一軍に見えて、実はベンチ入りすら怪しいぞ。",
    "リリースする時に『また会おう』と言うとるが、魚は二度と会いたくないそうじゃ。",
    "ボウズで帰る時の後ろ姿、哀愁が漂いすぎて堤防の幽霊かと思ったわ。",
    "高級リールを使えば釣れると思っとるのか？ 魚はリールの値段を知らんぞ。",
    "お前のキャスト精度、魚を狙うより電線を狙う方が向いとるな。",
    "時合を逃してスマホを見とる場合か！ 集中しろ！",
    "隣の人が釣れた時に『タナは何ですか？』と聞く時の顔、必死すぎて怖いぞ。",
    "新しいロッドを買ったことを家族に隠しとるな？ 魚にはバレとるぞ。",
    "魚が跳ねただけで『ナブラだ！』と叫ぶのはやめなさい。あれはボラじゃ。",
    "お前がルアーを投げると、魚たちが『また変なのが来たぞ』と会議を始めとるわ。",
    "その糸の結び方…、大きな魚がかかったら秒で泣きを見るぞ。",
    "釣り場に落ちているゴミを拾いなさい。そうすれば魚の方から寄ってくるわい。",
    "釣りすぎも良くないが、釣れなさすぎも考えものじゃ。今日はもう帰りなさい。",
    "魚を探す前に、まずは自分の落ち着きを探すんじゃな。",
    "お前のライフジャケット、オシャレじゃが、中身（腕前）が伴っておらんのう。",
    "『今日は潮が悪い』。その言葉、お前はもう一生分使ったぞ。",
    "クーラーボックスが重いと思ったら、自分の飲み物しか入っておらんのかい！",
    "魚を釣る前に、自分の服のフックを外す練習をせい。",
    "そのドラグ設定、魚が掛かった瞬間に糸が切れる未来しか見えんぞ。",
    "アタリがない時に『魚がおらん』と言うが、魚の方はお前をしっかり見とるぞ。",
    "朝マズメに寝坊したショックで、一日中魂が抜けとるな。",
    "お前のルアーの動かし方、魚から見れば『ただの棒』じゃ。",
    "釣具屋のポイントカードの溜まり具合だけは、プロ級じゃのう。",
    "ライフジャケットを忘れるとは…命を捨てる気か！ 釣りの前に常識を釣れ。",
    "大物が来たらタモを忘れたことに気づく。それがお前の運命（さだめ）じゃ。",
    "『このルアーは釣れる』という動画に騙されすぎじゃ。腕を磨け。",
    "釣り場でカップラーメンを食う時が、一番いい顔しとるぞ。",
    "お前のキャスティング、飛距離より音のうるささの方が目立っとるわい。",
    "魚のサイズを測る時に、少しだけ定規をずらしたな？ 仙人は見とるぞ。",
    "ボウズで帰って、スーパーの刺身パックを買うのは虚しくないか？",
    "そのラインの傷を無視したな？ 次のヒットで後悔することになるぞ。",
    "ポイントを独占しようとする心。それが魚を遠ざけておるんじゃ。",
    "サビキで一喜一憂しとる姿、初心を思い出させてくれて感謝するぞ。",
    "お前のタックルバランス、ガタガタじゃ。まずは基本に立ち返れ。",
    "魚は釣れんが、地球（根掛かり）だけはよく釣る男じゃのう。",
    "釣れた時のドヤ顔、TikTokで晒されんように気をつけるんじゃな。"
]

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/analyze', methods=['POST'])
def analyze():
    # スコア設定
    score = random.randint(0, 120)
    
    title = f"{random.choice(styles)}{random.choice(jobs)}"
    advice = random.choice(comments)
    
    # スコアに応じた特別コメントの挿入
    if score >= 100:
        advice = "おぬし…もはや魚そのものじゃな。人間に戻ってくるのを待っておるぞ。"
    elif score <= 10:
        advice = "今日は釣具屋に行って、店員さんとお喋りして帰るのが一番の幸せじゃぞ。"

    res = f"【称号】：{title}\n【適正】：{score}%\n\n【仙人の一言】：\n{advice}"
    return jsonify({'result': res})
